## III.1 Fourier expansions

In Part III, Computing with Functions, we work with approximating functions by expansions in
bases: that is, instead of approximating at a grid (as in the Differential Equations chapter),
we approximate functions by other, simpler, functions. The ultimate goal is to use such expansions
to numerically approximate solutions to ordinary and partial differential equations.




1. Review of Fourier series
2. Trapezium rule and discrete Fourier coefficients

## 1. Review of Fourier series



The most fundamental basis is (complex) Fourier: we have ${\rm e}^{{\rm i} k Î¸}$
are orthogonal with respect to the inner product
$$
âŸ¨f, g âŸ© := {1 \over 2Ï€} âˆ«_0^{2Ï€} fÌ„(Î¸) g(Î¸) {\rm d}Î¸,
$$
where we conjugate the first argument to be consistent with the vector inner product $ğ±^â‹† ğ²$.
We can (typically) expand functions in this basis:

**Definition 1 (Fourier)** A function $f$ has a Fourier expansion if
$$
f(Î¸) = âˆ‘_{k = -âˆ}^âˆ fÌ‚â‚– {\rm e}^{{\rm i} k Î¸}
$$
where
$$
fÌ‚â‚– := âŸ¨{\rm e}^{{\rm i} k Î¸}, fâŸ© = {1 \over 2Ï€} âˆ«_0^{2Ï€}  {\rm e}^{-{\rm i} k Î¸} f(Î¸) {\rm d}Î¸
$$

A basic observation is if a Fourier expansion has no negative terms it is equivalent to a Taylor series
if we write $z = {\rm e}^{{\rm i} Î¸}$:

**Definition 2 (Fourierâ€“Taylor)** A function $f$ has a Fourierâ€“Taylor expansion if
$$
f(Î¸) = âˆ‘_{k = 0}^âˆ fÌ‚â‚– {\rm e}^{{\rm i} k Î¸}
$$
where $fÌ‚â‚– := âŸ¨{\rm e}^{{\rm i} k Î¸}, fâŸ©$.



In numerical analysis we try to build on the analogy with linear algebra as much as possible.
Therefore we  can write this this as:
$$
f(Î¸) = \underbrace{[1 | {\rm e}^{{\rm i}Î¸} | {\rm e}^{2{\rm i}Î¸} | â‹¯]}_{T(Î¸)}
\underbrace{\begin{bmatrix} fÌ‚_0 \\ fÌ‚_1 \\ fÌ‚_2 \\ â‹® \end{bmatrix}}_{ğŸÌ‚}.
$$
Essentially, expansions in bases are viewed as a way of turning _functions_ into (infinite) _vectors_.
And (differential) _operators_ into _matrices_.




In analysis one typically works with continuous functions and relates results to continuity.
In numerical analysis we inheritely have to work with _vectors_, so it is more natural
to  focus on the case where the _Fourier coefficients_ $fÌ‚_k$ are _absolutely convergent_:


**Definition 3 (absolute convergent)** We write
$ğŸÌ‚ âˆˆ â„“^1$ if it is absolutely convergent,
or in otherwords, the $1$-norm of $ğŸÌ‚$ is bounded:
$$
\|ğŸÌ‚\|_1 := âˆ‘_{k=-âˆ}^âˆ |fÌ‚_k| < âˆ
$$

We first state a couple basic results (whose proof is beyond the scope of this module):

**Theorem 1 (2-norm convergence)**
A function $f$ has bounded 2-norm
$$
\| f \|_2 := \sqrt{âŸ¨f,fâŸ©} = \sqrt{\int_0^{2Ï€} |f(Î¸)|^2 {\rm d} Î¸} < âˆ
$$
if and only if
$$
\|ğŸÌ‚ \|_2 = \sqrt{ğŸÌ‚^â‹†ğŸÌ‚} = \sqrt{âˆ‘_{k = -âˆ}^âˆ |fÌ‚_k|^2} < âˆ.
$$
In this case
$$
\| f - \lim_{m â†’ âˆ} âˆ‘_{k = -m}^m fÌ‚â‚– {\rm e}^{{\rm i} k Î¸} \| â†’ 0
$$

**Theorem 2 (Absolute convergence)**
If $ğŸÌ‚ âˆˆ â„“^1$ then
$$
f(Î¸) = âˆ‘_{k = -âˆ}^âˆ fÌ‚â‚– {\rm e}^{{\rm i} k Î¸},
$$
which converges uniformly.


Continuity gives us sufficient (though not necessary) conditions for absolute convergence:

**Lemma 1 (differentiability and absolutely convergence)** If $f : â„ â†’ â„‚$ and $f'$ are periodic
 and $f''$ is uniformly bounded, then $ğŸÌ‚ âˆˆ â„“^1$.

**Proof**
Integrate by parts twice using the fact that $f(0) = f(2Ï€)$, $f'(0) = f(2Ï€)$:
$$
\begin{align*}
2Ï€fÌ‚â‚– &= âˆ«_0^{2Ï€} f(Î¸) {\rm e}^{-{\rm i} k Î¸} {\rm d}Î¸ =
[f(Î¸) {\rm e}^{-{\rm i} k Î¸}]_0^{2Ï€} + {1 \over {\rm i} k} âˆ«_0^{2Ï€} f'(Î¸) {\rm e}^{-{\rm i} k Î¸} {\rm d}Î¸ \\
&= {1 \over {\rm i} k} [f'(Î¸) {\rm e}^{-{\rm i} k Î¸}]_0^{2Ï€} - {1 \over k^2} âˆ«_0^{2Ï€} f''(Î¸) {\rm e}^{-{\rm i} k Î¸} {\rm d}Î¸ \\
&= - {1 \over k^2} âˆ«_0^{2Ï€} f''(Î¸) {\rm e}^{-{\rm i} k Î¸} {\rm d}Î¸
\end{align*}
$$
thus uniform boundedness of $f''$ guarantees $|fÌ‚â‚–| â‰¤Â M |k|^{-2}$ for some $M$, and we have
$$
âˆ‘_{k = -âˆ}^âˆ |fÌ‚â‚–| â‰¤ |fÌ‚_0|  + 2M âˆ‘_{k = 1}^âˆ |k|^{-2}  < âˆ.
$$
using the dominant convergence test.

âˆ

This condition can be weakened to Lipschitz continuity but the proof is  beyond the scope
of this module.
Of more practical importance is the other direction: the more times differentiable a function the
faster the coefficients decay, and thence the faster Fourier expansions converge.
In fact, if a function is smooth and 2Ï€-periodic its Fourier coefficients decay
faster than algebraically: they decay like $O(k^{-Î»})$ for any $Î»$. This will be explored in the
problem sheet.

**Remark (advanced)** Going further, if we let $z = {\rm e}^{{\rm i} Î¸}$ then if $f(z)$ is _analytic_ in a
neighbourhood of the unit circle the Fourier coefficients decay _exponentially fast_. And if $f(z)$ is entire
they decay even faster than exponentially.


## 2. Trapezium rule and discrete Fourier coefficients



**Definition 4 (Trapezium Rule)** Let $Î¸_j = 2Ï€j/n$ for $j = 0,1,â€¦,n$ denote $n+1$ evenly spaced points over $[0,2Ï€]$.
The _Trapezium rule_ over $[0,2Ï€]$ is the approximation:
$$
âˆ«_0^{2Ï€} f(Î¸) {\rm d}Î¸ â‰ˆ {2 Ï€ \over n} \left[{f(0) \over 2} + âˆ‘_{j=1}^{n-1} f(Î¸_j) + {f(2 Ï€) \over 2} \right]
$$
But if $f$ is periodic we have $f(0) = f(2Ï€)$ we get the _periodic Trapezium rule_:
$$
âˆ«_0^{2Ï€} f(Î¸) {\rm d}Î¸ â‰ˆ 2 Ï€\underbrace{{1 \over n} âˆ‘_{j=0}^{n-1} f(Î¸_j)}_{Î£_n[f]}
$$


**Definition 5 (Discrete Fourier coefficients)** Define the Trapezium rule approximation to the Fourier coefficients by:
$$
fÌ‚_k^n := Î£_n[{\rm e}^{-i k Î¸} f(Î¸)]  = {1 \over n} âˆ‘_{j=0}^{n-1} {\rm e}^{-i k Î¸_j} f(Î¸_j)
$$

We know that ${\rm e}^{{\rm i} k Î¸}$ are orthogonal with respect to the continuous inner product.
The following says that this property is maintained (up to "aliasing") when we replace the continuous
integral with a trapezium rule approximation:

**Lemma 2 (Discrete orthogonality)**
We have:
$$
âˆ‘_{j=0}^{n-1} {\rm e}^{{\rm i} k Î¸_j} =
\begin{cases} n & k = \ldots,-2n,-n,0,n,2n,\ldots  \cr
              0 & \hbox{otherwise}
\end{cases}
$$
In other words,
$$
Î£_n[{\rm e}^{{\rm i} (k-j) Î¸_j}] =
\begin{cases} 1 & k-j = \ldots,-2n,-n,0,n,2n,\ldots  \cr
              0 & \hbox{otherwise}
\end{cases}.
$$

**Proof**

Consider $Ï‰ := {\rm e}^{{\rm i} Î¸_1} = {\rm e}^{2 Ï€ {\rm i} \over n}$. This is an $n$ th root of unity: $Ï‰^n = 1$.
Note that ${\rm e}^{{\rm i} Î¸_j} ={\rm e}^{2 Ï€ {\rm i} j \over n}= Ï‰^j$.

(Case 1: $k = pn$ for an integer $p$)
We have
$$
âˆ‘_{j=0}^{n-1} {\rm e}^{{\rm i} k Î¸_j} = âˆ‘_{j=0}^{n-1} Ï‰^{kj} = âˆ‘_{j=0}^{n-1} ({Ï‰^{pn}})^j =   âˆ‘_{j=0}^{n-1} 1 = n
$$
(Case 2 $k â‰  pn$ for an integer $p$)  Recall that
$$
âˆ‘_{j=0}^{n-1} z^j = {z^n-1 \over z-1}.
$$
Then we have
$$
âˆ‘_{j=0}^{n-1} {\rm e}^{{\rm i} k Î¸_j} = âˆ‘_{j=0}^{n-1} (Ï‰^k)^j = {Ï‰^{kn} -1 \over Ï‰^k -1} = 0.
$$
where we use the fact that $k$ is not a multiple of $n$ to guarantee that $Ï‰^k â‰ Â 1$.

âˆ


**Theorem 3 (discrete Fourier coefficients)**
If $ğŸÌ‚$ is absolutely convergent then
$$
fÌ‚_k^n = â‹¯ + fÌ‚_{k-2n} + fÌ‚_{k-n} + fÌ‚_k + fÌ‚_{k+n} + fÌ‚_{k+2n} + â‹¯
$$

**Proof**
$$
\begin{align*}
fÌ‚_k^n &= Î£_n[f(Î¸) {\rm e}^{-i k Î¸}] = âˆ‘_{j=-âˆ}^âˆ fÌ‚_j Î£_n[{\rm e}^{{\rm i} (j-k) Î¸}] \\
&= âˆ‘_{j=-âˆ}^âˆ fÌ‚_j \begin{cases} 1 & j-k = \ldots,-2n,-n,0,n,2n,\ldots  \cr
0 & \hbox{otherwise}
\end{cases}
\end{align*}
$$
âˆ

Note that there is redundancy:

**Corollary 1 (aliasing)**
For all $p âˆˆ â„¤$, $fÌ‚_k^n = fÌ‚_{k+pn}^n$.


In other words if we know $fÌ‚_0^n, â€¦, fÌ‚_{n-1}^n$, we know $fÌ‚_k^n$ for all $k$ via a permutation,
for example if $n = 2m+1$ we have
$$
\begin{bmatrix}
fÌ‚_{-m}^n \\
â‹®\\
fÌ‚_m^n
\end{bmatrix} = \underbrace{\begin{bmatrix} &&& 1 \\ &&&& â‹± \\ &&&&& 1 \\
    1 \\ & â‹± \\ && 1 \end{bmatrix}}_{P_Ïƒ}
\begin{bmatrix}
fÌ‚_0^n \\
â‹®\\
fÌ‚_{n-1}^n
\end{bmatrix}
$$
where $Ïƒ$ has Cauchy notation (_Careful_: we are using 1-based indexing here):
$$
\begin{pmatrix}
1 & 2 & â‹¯ & m & m+1 & m+2 & â‹¯ & n  \\
m+2 & m+3 & â‹¯ & n & 1 & 2 & â‹¯ & m+1
\end{pmatrix}.
$$



We first discuss the case when all negative coefficients are zero.
That is, $fÌ‚_0^n, â€¦, fÌ‚_{n-1}^n$ are approximations of the Fourierâ€“Taylor coefficients by evaluating
on the boundary.



We can  prove _convergence_ whenever of this
approximation whenever $f$ has absolutely summable coefficients.
We will prove the result here in the special case where the negative
coefficients are zero.


**Theorem  4 (Approximate Fourierâ€“Taylor expansions converge)**
If $0 = fÌ‚_{-1} = fÌ‚_{-2} = â‹¯$ and $ğŸÌ‚$ is absolutely convergent then
$$
f_n(Î¸) = âˆ‘_{k=0}^{n-1} fÌ‚_k^n {\rm e}^{{\rm i} k Î¸}
$$
converges uniformly to $f(Î¸)$.

**Proof**

$$
\begin{align*}
|f(Î¸) - f_n(Î¸)| = |âˆ‘_{k=0}^{n-1} (fÌ‚_k - fÌ‚_k^n) {\rm e}^{{\rm i} k Î¸} + âˆ‘_{k=n}^âˆ fÌ‚_k {\rm e}^{{\rm i} k Î¸}|
= |âˆ‘_{k=n}^âˆ fÌ‚_k ({\rm e}^{{\rm i} k Î¸} - {\rm e}^{{\rm i} {\rm mod}(k,n) Î¸})|
â‰¤ 2 âˆ‘_{k=n}^âˆ |fÌ‚_k|
\end{align*}
$$
which goes to zero as $n â†’ âˆ$.
âˆ

For the general case we need to choose a range of coefficients that includes roughly an equal number of
negative and positive coefficients (preferring negative over positive in a tie as a convention):
$$
f_n(Î¸) = âˆ‘_{k=-âŒˆn/2âŒ‰}^{âŒŠn/2âŒ‹} fÌ‚â‚– {\rm e}^{{\rm i} k Î¸}
$$
In the problem sheet we will prove this converges provided the coefficients are absolutely convergent.





