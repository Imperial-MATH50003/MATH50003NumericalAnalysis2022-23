# MATH50003 Numerical Analysis (2022â€“23)
# Problem Sheet 5

This problem sheet concerns Given's rotations, Householder reflections and QR factorisations.

-----

**Problem 1.1** Consider the vectors
$$
ğš = \begin{bmatrix} 1 \\ 2 \\ 2 \end{bmatrix}\qquad\hbox{and}\qquad  ğ› = \begin{bmatrix} 1 \\ 2{\rm i} \\ 2 \end{bmatrix}.
$$
Use reflections to determine the entries of orthogonal/unitary matrices $Q_1, Q_2, Q_3$ such that
$$
Q_1 ğš = \begin{bmatrix} 3 \\ 0 \\ 0 \end{bmatrix}, Q_2 ğš = \begin{bmatrix} -3 \\ 0 \\ 0 \end{bmatrix},
Q_3 ğ› = \begin{bmatrix} \sqrt{3} \\ 0 \\ 0 \end{bmatrix}
$$

**SOLUTION**

For $Q_1$: we have
$$
\begin{align*}
ğ² = ğš - \| ğš\| ğ_1 =  \begin{bmatrix} -2 \\ 2 \\ 2 \end{bmatrix} \\
ğ° = {ğ² \over \|ğ²\|} = {1 \over \sqrt{3}} \begin{bmatrix} -1 \\ 1 \\ 1 \end{bmatrix} \\
Q_1 = Q_{ğ°} = I - {2 \over 3} \begin{bmatrix} -1 \\ 1 \\ 1 \end{bmatrix}  [-1\ 1\ 1] = 
I - {2 \over 3} \begin{bmatrix} 1 & -1 & -1 \\ -1 & 1 & 1 \\ -1 & 1 & 1 \end{bmatrix} \\
&={1 \over 3} \begin{bmatrix} 1 & 2 & 2 \\ 2 & 1 & -2 \\ 2 & -2 & 1 \end{bmatrix} 
\end{align*}
$$

For $Q_2$: we have
$$
\begin{align*}
ğ² = ğš + \| ğš\| ğ_1 =  \begin{bmatrix} 4 \\ 2 \\ 2 \end{bmatrix} \\
ğ° = {ğ² \over \|ğ²\|} = {1 \over \sqrt{6}} \begin{bmatrix} 2 \\ 1 \\ 1 \end{bmatrix} \\
Q_1 = Q_{ğ°} = I - {1 \over 3} \begin{bmatrix} 2 \\ 1 \\ 1 \end{bmatrix}  [2 1 1] = 
I - {1 \over 3} \begin{bmatrix} 4 & 2 & 2 \\ 2 & 1  & 1 \\ 2&  1 & 1 \end{bmatrix} \\
&={1 \over 3} \begin{bmatrix} -1 & -2 & -2 \\ -2& 2 &-1 \\ -2& -1& 2 \end{bmatrix} 
\end{align*}
$$

For $Q_3$ we just need to be careful to conjugate:
$$
\begin{align*}
ğ² = ğ› - \| ğ›\| ğ_1 =  \begin{bmatrix} -2 \\ 2{\rm i} \\ 2 \end{bmatrix} \\
ğ° = {ğ² \over \|ğ²\|} = {1 \over \sqrt{3}} \begin{bmatrix} -1 \\ {\rm i} \\ 1 \end{bmatrix} \\
Q_1 = Q_{ğ°} = I - {2 \over 3} \begin{bmatrix} -1 \\ {\rm i} \\ 1 \end{bmatrix}  [-1\ -{\rm i}\ 1] = 
I - {2 \over 3} \begin{bmatrix} 1 & {\rm i} & -1 \\ -{\rm i}& 1 & {\rm i} \\ -1 &-{\rm i} & 1 \end{bmatrix} \\
&={1 \over 3} \begin{bmatrix} 1 & -2{\rm i} & 2 \\ 2{\rm i} & 1 & -2{\rm i} \\ 2& 2{\rm i} & 1 \end{bmatrix} 
\end{align*}
$$



**END**

**Problem 1.2** What simple rotation matrices $Q_1,Q_2 âˆˆ SO(2)$ have the property that:
$$
Q_1 \begin{bmatrix} 1 \\ 2 \end{bmatrix} =\begin{bmatrix} \sqrt{5} \\ 0 \end{bmatrix},  Q_2 \begin{bmatrix} \sqrt{5} \\ 2 \end{bmatrix} =  \begin{bmatrix} 3 \\ 0 \end{bmatrix}
$$

**SOLUTION**

The rotation that takes $[x,y]$ to the x-axis is
$$
{1 \over \sqrt{x^2+y^2}} \begin{bmatrix}
x & y \\
-y & x
\end{bmatrix}.
$$
Hence we get
$$
\begin{align*}
Q_1 &= {1 \over \sqrt{5}} \begin{bmatrix} 1 & 2 \\ -2 & 1 \end{bmatrix} \\
Q_2 &= {1 \over 3} \begin{bmatrix} \sqrt{5} & 2 \\ -2 & \sqrt{5} \end{bmatrix}
\end{align*}
$$


**END**

**Problem 1.3** Find an orthogonal matrix that is a product of two simple rotations but
acting on two different subspaces:
$$
Q  = \underbrace{\begin{bmatrix} \cos Î¸_2 & & -\sin Î¸_2  \\ & 1 \\
\sin Î¸_2  & & \cos Î¸_2  \end{bmatrix}}_{Q_2} \underbrace{\begin{bmatrix} \cos Î¸_1 & -\sin Î¸_1  \\ \sin Î¸_1 & \cos Î¸_1 \\ && 1 \end{bmatrix}}_{Q_1}
$$
so that, for $ğš$ defined in 1.1, 
$$
Q ğš  = \begin{bmatrix} \|ğš\| \\ 0 \\ 0 \end{bmatrix}.
$$
Hint: you do not need to determine $Î¸_1, Î¸_2$, instead you can write the entries of  $Q_1, Q_2$ 
directly using just square-roots. 

**SOLUTION**

We use $Q_1$ to introduce a 0 in the second entry by rotating the vector $[1,2]$:
$$
Q_1 =  \begin{bmatrix} 1/\sqrt{5}  & 2/\sqrt{5} \\ -2/\sqrt{5} & 1/\sqrt{5} \\ && 1 \end{bmatrix}
$$
so that
$$
Q_1 ğš = \begin{bmatrix} \sqrt{5} \\ 0 \\ 2 \end{bmatrix}.
$$
Now we use the matrix that rotates the vector $[\sqrt{5},2]$ whose norm is $3$ to deduce the entries
$$
Q_2 = \begin{bmatrix} \sqrt{5}/3 & & 2/3  \\ & 1 \\
-2/3  & & \sqrt{5}/3  \end{bmatrix}
$$
so that
$$
Q_2 Q_1 = \begin{bmatrix} 1/3 & 2/3 & 2/3 \\ 
 -2/\sqrt{5} & 1/\sqrt{5} & \\ 
 -2/(3\sqrt{5}) & -4/(3\sqrt{5}) & \sqrt{5}/3
 \end{bmatrix}
$$


**END**

------

**Problem 2.1** Show that every matrix $A âˆˆ â„^{m Ã— n}$ has a  QR factorisation such that the diagonal of $R$ is non-negative.
Make sure to include the case of more columns than rows (i.e. $m < n$). You may use the fact from lectures that a QR factorisation
exists (but not necessarily with positive diagonals) whenever $m â‰¥Â n$.

**SOLUTION**

We first show for $m < n$ that a QR decomposition exists. Writing
$$
A = [ğš_1 | â‹¯ | ğš_n]
$$
and let $A = [ğš_1 | â‹¯ | ğš_m] = Q R_m$. It follows that $R := Q^â‹† A$ is right-triangular.

We can write:
$$
D = \begin{bmatrix} \hbox{sign}(r_{11}) \\ & â‹±  \\ && \hbox{sign}(r_{pp}) \end{bmatrix}
$$
where $p = \min(m,n)$ and we define $\hbox{sign}(0) = 1$. Note that $D^âŠ¤ D = I$. Thus we can write:
$A = Q R = Q D D R$
where $(QD)$ is orthogonal and $DR$ is upper-triangular with positive entries.


**END**

**Problem 2.2** Show that the QR factorisation of a square invertible matrix $A âˆˆ â„^{n Ã— n}$ is unique,
provided that the diagonal of $R$ is positive. You may use Problem 3.5 from PS4, which
states that an orthogonal matrix whose eigenvalues are all 1 must be equal to the identity.
Hint: a product of two orthogonal matrices is also orthogonal.

**SOLUTION**

Assume there is a second factorisation also with positive diagonal
$$
A = QR = QÌƒ  RÌƒ
$$
Then we know
$$
Q^âŠ¤ QÌƒ  = R RÌƒ^{-1}
$$
Note $Q^âŠ¤ QÌƒ $ is orthogonal, and $R RÌƒ^{-1}$ has positive eigenvalues (the diagonal), hence all $m$ eigenvalues of
$Q^âŠ¤ QÌƒ $ are 1. This means that $Q^âŠ¤ QÌƒ  = I$ and hence $QÌƒ = Q$, which then implies $RÌƒ = R$.âˆ
**END**

-------

**Problem 3.1** Show that if $U$ is triangular and normal ($U^â‹† U = U U^â‹†$) then it is diagonal.

**SOLUTION**
Note
$$
|u_{11}|^2 = ğ_1^âŠ¤ U^â‹† U ğ_1 = ğ_1^âŠ¤ U U^â‹† ğ_1 = âˆ‘_{j = 1}^n |u_{1j}|^2
$$
which implies that $u_{1j} = 0$ for $j â‰ Â 1$. Writing
$$
U = \begin{bmatrix} u_{11}  \\ & UÌƒ \end{bmatrix}
$$
we note that
$$
\begin{bmatrix} |u_{11}|^2  \\ & UÌƒ UÌƒ^â‹† \end{bmatrix} = U U^â‹† = U U^â‹† = \begin{bmatrix} |u_{11}|^2 \\ & UÌƒ^â‹† UÌƒ \end{bmatrix}
$$
hence $UÌƒ$ is also normal. The result follows from induction.

**END**


**Problem 3.2â‹†** Show that every matrix $A âˆˆ â„‚^{n Ã— n}$ has a _Schur decomposition_: it can be written
as
$$
A = Q U Q^â‹†
$$
where $U$ is upper-triangular with the eigenvalues of $A$ on the diagonal. Hint: you may use the Jordan canonical form
$$
A = V J V^{-1}
$$
where $J$ is upper-triangular with eigenvalues of $A$ on the diagonal.

**SOLUTION**

Write $V = QR$  so that
$$
A = V J V^{-1} = Q \underbrace{R J R^{-1}}_U Q^â‹†
$$
Because conjugation with $Q$ is a similarity transformation we know the eigenvalues of $U$ are the same as $A$.

**END**

**Problem 3.3â‹†** Prove the spectral theorem for normal matrices: for every normal matrix $A âˆˆ â„‚^{n Ã— n}$
 there exists a unitary matrix $Q$ such that
$$
A = Q Î› Q^â‹†
$$
where $Î›$ is diagonal.

**SOLUTION**

We know we have a Schur decomposition $A = Q U Q^â‹†$ so need to show that $U$ is diagonal. Note that:
$$
Q U^â‹† U Q^â‹† = A^â‹† A =  A A^â‹† = Q U U^â‹† Q^â‹†
$$
hene we have $U^â‹† U = U U^â‹†$.  The result thus follows from Problem 3.1.

**END**