# MATH50003 Numerical Analysis (2022â€“23)
# Problem Sheet 4

This problem sheet concerns matrix multiplication, permutation matrices, and properties of orthogonal/unitary matrices.



**Problem 1.1** True or false: `mul_rows(A, x)` and `mul_cols(A, x)` from the lectures/notes 
will always return the exact same result if the input are floating point? Explain your answer.

**SOLUTION**

True. Even though the implementations are different the mathematical operations are still performed
for each entry in the same way. On the other hand, if we had an implementation that reversed the
order the columns/rows are traversed this would change the answer.

**END**

**Problem 1.2** Show when implemented in floating point arithmetic for $A âˆˆ F^{m Ã— n}$ and $ğ± âˆˆ F^n$ that
$$
{\rm mul_rows}(A, ğ±) = A ğ± + \mathbf{Î´} 
$$
where
$$
\| Î´ \|_1 â‰¤ \|A\|_âˆ \| ğ± \|_âˆ E_{n-1,Ïµ_{\rm m}/2}
$$
and
$$
E_{n,Îµ} := {n Îµ\over 1-nÎµ},
$$
assuming that $n Ïµ_{\rm m} < 2$. 
We use the notation (to be discussed in detail later):
$$
\|A \|_1 := \max_k âˆ‘_{j=1}^n |a_{kj}|, \|ğ±\|_1 := âˆ‘_{k=1}^n |x_k|. 
$$

**Proof**
Each entry of $mul_rows(A, ğ±)$ is of the form 
$$
â¨_{j=1}^n A_{k,j} âŠ— x_j =  â¨_{j=1}^n A_{k,j} x_j (1+Î´_j) = 
âˆ‘_{j=1}^n A_{k,j} x_k (1+Î´_j) + Ïƒ_n
$$
where
$$
M_k = Î£_{j=1}^n |A_{k,j}| |x_k| (1+Î´_j) 
$$


------

**Problem 2** What are the permutation matrices corresponding to the following permutations?
$$
\begin{pmatrix}
1 & 2 & 3 \\
3 & 2 & 1
\end{pmatrix}, \begin{pmatrix}
1 & 2 & 3 & 4 & 5 & 6\\
2 & 1 & 4 & 3 & 6 & 5
\end{pmatrix}.
$$

**SOLUTION**

Let
$$
Ïƒ=\begin{pmatrix}1 & 2 & 3 \\ 3 & 2 & 1\end{pmatrix}, Ï„=\begin{pmatrix}1 & 2 & 3 & 4 & 5 & 6\\ 2 & 1 & 4 & 3 & 6 & 5\end{pmatrix}.
$$
There are two ways to construct $P_Ïƒ$ and $P_Ï„$.

- Column by column:
  $$P_Ïƒ=
  \left(ğ_{Ïƒ_1^{-1}}\middle|ğ_{Ïƒ_2^{-1}}\middle|ğ_{Ïƒ_3^{-1}}\right)=
  \left(ğ_3\middle|ğ_2\middle|ğ_1\right)$$
  $$P_Ï„=
  \left(ğ_{Ï„_1^{-1}}\middle|ğ_{Ï„_2^{-1}}\middle|ğ_{Ï„_3^{-1}}\middle|ğ_{Ï„_4^{-1}}\middle|ğ_{Ï„_5^{-1}}\middle|ğ_{Ï„_6^{-1}}\right)=
  \left(ğ_2\middle|ğ_1\middle|ğ_4\middle|ğ_3\middle|ğ_6\middle|ğ_5\right)$$
- Row by row:
  $$P_Ïƒ=I[\mathbf{Ïƒ},:]=
  \begin{pmatrix}
  I[Ïƒ_1,:]\\
  I[Ïƒ_2,:]\\
  I[Ïƒ_3,:]
  \end{pmatrix}=
  \begin{pmatrix}
  I[3,:]\\
  I[2,:]\\
  I[1,:]
  \end{pmatrix}$$
  $$P_Ï„=I[\mathbf{Ï„},:]=
  \begin{pmatrix}
  I[Ï„_1,:]\\
  I[Ï„_2,:]\\
  I[Ï„_3,:]\\
  I[Ï„_4,:]\\
  I[Ï„_5,:]\\
  I[Ï„_6,:]\\
  \end{pmatrix}=
  \begin{pmatrix}
  I[2,:]\\
  I[1,:]\\
  I[4,:]\\
  I[3,:]\\
  I[6,:]\\
  I[5,:]\\
  \end{pmatrix}$$

Either way, we have
$$P_Ïƒ=
\begin{pmatrix}
0 & 0 & 1\\ 
0 & 1 & 0\\ 
1 & 0 & 0
\end{pmatrix}
\qquad\text{and}\qquad
P_Ï„=
\begin{pmatrix}
0 & 1 & 0 & 0 & 0 & 0 \\
1 & 0 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 1 \\
0 & 0 & 0 & 0 & 1 & 0
\end{pmatrix}
$$
**END**
-------

**Problem 3.1** Show for a unitary matrix $Q âˆˆ U(n)$ and a vector $ğ± âˆˆ â„‚^n$ that multiplication by Q$ preserve the 2-norm:
$$
\|Q ğ±\| = \|ğ±\|.
$$

**SOLUTION**
$$
\|Q ğ±\|^2 = (Q ğ±)^â‹† Q ğ± = ğ±^â‹† Q^â‹† Q ğ± = ğ±^â‹†  ğ± = \|ğ±\|^2
$$
**END**

**Problem 3.2** Show that the eigenvalues $Î»$ of a unitary matrix $Q$ are
on the unit circle: $|Î»| = 1$. Hint: recall for any eigenvalue $Î»$ that there exists a unit vector
$ğ¯ âˆˆ â„‚^n$ (satisfying $\| ğ¯ \| = 1$). Comine this with Problem 3.1.

**SOLUTION**
Let $ğ¯$ be a unit eigenvector corresponding to $Î»$: $Q ğ¯ = Î» ğ¯$ with $\|ğ¯\| = 1$. Then
$$
1 = \| ğ¯ \| = \|Q ğ¯ \| =  \| Î» ğ¯ \| = |Î»|.
$$

**END**

**Problem 3.3** Show that $Q âˆˆ U(n)$ is a normal matrix (that it commutes with its adjoint).

**SOLUTION**
$$
 QQ^â‹† = I = Q^â‹†Q
$$
**END**

**Problem 3.4** 
Explain why  $Q âˆˆ U(n)$ must be equal to $I$ if all its eigenvalues are 1.
Hint: use the spectral theorem, which says that any normal matrix is diagonalisable
with unitary eigenvectors (see notes on C. Adjoints and Normal Matrices).

**SOLUTION**

Note that $Q$ is normal and therefore by the spectral theorem for 
normal matrices we have
$$
Q = QÌƒ Î› QÌƒ^â‹† = QÌƒ QÌƒ^â‹† = I
$$
since $QÌƒ$ is unitary. 

**END**