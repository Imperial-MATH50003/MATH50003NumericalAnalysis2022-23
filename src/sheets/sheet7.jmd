# MATH50003 Numerical Analysis (2022â€“23)
# Problem Sheet 7

This problem sheet concerns singular value decompositions, pseudo-inverses,
and condition numbers.

-----

For the SVD $A = U Î£ V^âŠ¤ âˆˆ â„^{m Ã— n}$, where $U âˆˆ â„^{m Ã— r}$ and $V âˆˆ â„^{n Ã— r}$ have orthonormal columns
and $Î£$ is a diagonal matrix with non-increasing positive entries, define the _pseudo-inverse_:
$$
A^+ := V Î£^{-1} U^âŠ¤.
$$

**Problem 1.1**  Show that $A^+$ satisfies the _Moore-Penrose conditions_:
1. $A A^+ A = A$
2. $A^+ A A^+ = A^+$
3. $(A A^+)^âŠ¤  = A A^+$ and $(A^+ A)^âŠ¤ = A^+ A$



**Problem 1.2** Show for $A âˆˆ â„^{m Ã— n}$ with $m â‰¥ n$ and full rank
that $ğ± =  A^+ ğ›$ is the least squares solution, i.e., minimises $\| A ğ± - ğ› \|_2$.
Hint: extend $U$ in the SVD to be a square orthogonal matrix.



**Problem 1.3**
If $A âˆˆ â„^{m Ã— n}$ has a non-empty kernel there are multiple solutions to the least
squares problem as 
we can add any element of the kernel. Show that $ğ± = A^+ ğ›$ gives the least squares solution
such that $\| ğ± \|_2$ is minimised.




------



**Problem 2** Compute the 1-norm, 2-norm, and âˆ-norm condition numbers for the following matrices:
$$
\begin{bmatrix}
1 & 2 \\ 3 & 4
\end{bmatrix}, \begin{bmatrix}
1/3 & 1/5 \\ 0 & 1/7
\end{bmatrix}, \begin{bmatrix} 1 \\ & 1/2 \\ && â‹± \\ &&& 1/2^n \end{bmatrix}
$$
Hint: recall that the singular values of a matrix $A$ are the square roots of the eigenvalues of the Gram matrix
$A^âŠ¤A$.







--------

**Problem 3.1â‹†**
For $U âˆˆ â„^{n Ã— n}$, an upper triangular matrix such that the diagonal are all 1 ($u_{kk} = 1$)
and all entries are floats, 
show that backsubstitution implemented with floating point has a backward error formula:
$$
{\tt backsubstitution}(U, ğ›) = (U+Î´U)^{-1} (ğ› + Î´ğ›).
$$
Assuming $n Ïµ_{\rm m} < 2$ and all operations are in the
normalised range, show that
$$
\begin{align*}
|Î´b_k| &â‰¤ {Ïµ_{\rm m} \over 2} |b_k| \\
|Î´u_{k,j}| &â‰¤ E_{n-k+1,Ïµ_{\rm m}/2} |u_{k,j}|\qquad\hbox{for $j > k$} \\
|Î´u_{k,j}| &= 0 \qquad \hbox{for $j â‰¤ k$}
\end{align*}
$$
Hint: Note that if we write $ğ±Ìƒ = {\tt backsubstitution}(U, ğ›)$ then we have
$$
xÌƒ_k = b_k âŠ– {\tt dot}(U[k,k+1:n], ğ±Ìƒ[k+1:n]).
$$
You may then use II.7 Lemma 1. Further, note that if $|Î¸_k| â‰¤ E_{k,Îµ}$ and $|Î´| â‰¤ Îµ$  then
$|(1+Î¸_k) (1+Î´) - 1| â‰¤ E_{k+1,Îµ}$.




**Problem 3.2â‹†** Show that 
$$
\begin{align*}
\|Î´U\|_1 &â‰¤  E_{n,Ïµ_{\rm m}/2} \|U \|_1 \\
\|Î´U\|_2 &â‰¤  \sqrt{n} E_{n,Ïµ_{\rm m}/2} \|U \|_2 \\
\|Î´U\|_âˆ &â‰¤  E_{n,Ïµ_{\rm m}/2} \|U \|_âˆ
\end{align*}
$$


