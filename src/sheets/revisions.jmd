# MATH50003 Numerical Analysis (2022â€“23)
# Revision Sheet

-----

**Problem 1.1** State which integers are represented by an 8-bit signed (`Int8`) and unsigned (`UInt8`) integer, both with   bits
$$
{\tt 10000001}
$$

**SOLUTION**

For unsigned it is $2^7 + 1 = 129$. For signed, since the first bit is one, its $2^7 + 1 - 2^8 = -127$.

**END**

**Problem 1.2** State which real number is represented by an IEEE 16-bit floating point number (with $Ïƒ = 15, Q = 5$, and $S = 10$) with bits
$$
{\tt 1\ 01000\ 0000000001}
$$

**SOLUTION**
The sign bit is 1 so the answer is negative. The exponent bits correspond to
$$
q = 2^3 = 8
$$
The significand is
$$
(1.0000000001)_2 = 1 + 2^{-10}
$$
So this represents
$$
-2^{8-Ïƒ} (1 + 2^{-10}) = - 2^{-7} (1 + 2^{-10})
$$

**END**

-----

**Problem 2.1** Consider the truncated Taylor series for $1/(1-x)$:
$$
g_n(x) := âˆ‘_{k=0}^n x^k
$$
Write  a one-line mathematical function $g_n^t(x)$ approximating $g_n(x)$
using floating point operations  involving $âŠ•$, $âŠ˜$, and $âŠ—$.
You may find it convenient to use the notation:
$$
\begin{align*}
â¨_{k=1}^n x_k &:= x_1 âŠ• â‹¯ âŠ• x_n = (â‹¯((x_1 âŠ• x_2) âŠ• x_3)â‹¯ âŠ• x_{n-1}) âŠ• x_n \\
â¨‚_{k=1}^n x_k &:= x_1 âŠ— â‹¯ âŠ— x_n = (â‹¯((x_1 âŠ— x_2) âŠ— x_3)â‹¯ âŠ— x_{n-1}) âŠ— x_n \\
\end{align*}
$$

**SOLUTION**

$$
g_n^t(x) = 1 âŠ• \left(â¨_{k=1}^n â¨‚_{j=1}^k x \right)
$$

**END**

**Problem 2.2** Recall for $E_{n,Ïµ} := {n Ïµ \over 1-nÏµ}$ and $x_1,â€¦,x_n âˆˆ F$ that
$$
\begin{align*}
x_1 âŠ— â‹¯ âŠ— x_n &= x_1 â‹¯ x_n (1 + Î¸_{n-1}),\\
x_1 âŠ• â‹¯ âŠ• x_n &= x_1 +  â‹¯ + x_n + Ïƒ_n
\end{align*}
$$
where $|Î¸_n| â‰¤ E_{n,Ïµ_{\rm m}/2}$ and $|Ïƒ_n| â‰¤ M E_{n-1,Ïµ_{\rm m}/2}$, for $M = Î£_{k=1}^n |x_k|$
and  assuming $n Ïµ_{\rm m} < 2$.
Show for $x âˆˆ F$ such that $|x| < 1$
$$
g_n^t(x) = âˆ‘_{k=0}^n x^k + Îµ_n
$$
where
$$
|Îµ_n| â‰¤ {2E_{n,Ïµ_{\rm m}/2} + E_{n,Ïµ_{\rm m}/2}^2 \over  1- |x|}.
$$
You may assume all operations are normal.

**SOLUTION**

 Note for $x_0 := 1$ and
$$
x_k := â¨‚_{j=1}^k x = x^k (1+Î¸_{k-1})
$$
where $|Î¸_{k-1}| â‰¤ E_{n,Ïµ_{\rm m}/2}$. Note that
$$
M := âˆ‘_{k=0}^n |x_k| â‰¤Â âˆ‘_{k=0}^n (1+|Î¸_{k-1}|) |x|^k â‰¤ {1 + E_{n,Ïµ_{\rm m}/2} \over  1- |x|}
$$
Thus
$$
âŠ•_{k=0}^n x_k = âˆ‘_{k=0}^n x_k + Ïƒ_{n+1} = âˆ‘_{k=0}^n x^k + \underbrace{âˆ‘_{k=0}^n x^k Î¸_{k-1} + Ïƒ_{n+1}}_{Îµ_n}
$$
for
$$
|Ïƒ_{n+1}| â‰¤ M E_{n,Ïµ_{\rm m}/2}$ = {E_{n,Ïµ_{\rm m}/2} + E_{n,Ïµ_{\rm m}/2}^2 \over  1- |x|}.
$$
Thus
$$
|Îµ_n| â‰¤ {2E_{n,Ïµ_{\rm m}/2} + E_{n,Ïµ_{\rm m}/2}^2 \over  1- |x|}.
$$

**END**

----

**Problem 3** What is the dual extension of square-roots? I.e. what should $\sqrt{a + b Ïµ}$ equal assuming $a > 0$?

**SOLUTION**
$$
\sqrt{a + b Ïµ} = \sqrt{a} + {b \over 2 \sqrt{a}}  Ïµ
$$
**END**


------

**Problem 4** State the entries of the permutation matrix $P_Ïƒ$ corresponding to the permutation $Ïƒ$ with Cauchy representation
$$
\begin{pmatrix}
1 & 2 & 3 & 4 & 5 \\
1 & 5 & 4 & 3 & 2
\end{pmatrix}.
$$

**SOLUTION**
$$
\begin{bmatrix}
1 & 0 &0&0&0\\ 0&0&0&0& 1 \\
0&0&0& 1&0 \\
0&0& 1&0&0 \\
0& 1&0&0&0
\end{bmatrix}
$$
**END**

----

**Problem 5** Use reflections to determine the entries of an orthogonal matrix $Q$ such that
$$
Q \begin{bmatrix} 2 \\ 1 \\ 2 \end{bmatrix} =  \begin{bmatrix} -3 \\ 0 \\ 0 \end{bmatrix}.
$$

**SOLUTION**

$$
\begin{align*}
ğ± &:= [2,1,2], \| ğ± \| = 3\\
ğ² &:= \|ğ±\| ğ_1 + ğ± = [5,1,2], \| ğ² \| = \sqrt{30} \\
ğ° &:= ğ² / \| ğ² \| = [5,1,2] /  \sqrt{30} \\
Q &:= I - 2ğ° ğ°^âŠ¤ = I - {1 \over 15} \begin{bmatrix}5 \\ 1 \\ 2 \end{bmatrix} [5 1 2] = I - {1 \over 15} \begin{bmatrix} 25 & 5 & 10 \\5 & 1 & 2 \\ 10 & 2 & 4 \end{bmatrix} \\
&= {1 \over 15} \begin{bmatrix} -10 & -5 & -10 \\ -5 & 14 & -2 \\ -10 & -2 & 11 \end{bmatrix}
\end{align*}
$$

**END**

----

**Problem 6** Use the Cholesky factorisation to determine
whether the following matrix is symmetric positive definite:
$$
\begin{bmatrix} 2 & 2 & 1  \\
2 & 3 & 2\\
1 & 2 & 2
\end{bmatrix}
$$

**SOLUTION**

Here $Î±_1 = 2$ and $ğ¯ = [2,1]$ giving us
$$
\begin{align*}
A_2 &= \begin{bmatrix}
3&2\\
2&2
\end{bmatrix}-{1 \over 2} \begin{bmatrix} 2 \\ 1 \end{bmatrix}\begin{bmatrix} 2 & 1 \end{bmatrix}\\
&=
\begin{bmatrix}
1&1\\
1&3/2
\end{bmatrix}
\end{align*}
$$
Thus $Î±_2 = 1$ and $ğ¯ = [1]$ giving us
$$
\begin{align*}
A_3 &= [3/2 - 1] = [1/2]
\end{align*}
$$
As $Î±_3 = 1/2 > 0$ we know a Cholesky decomposition exists hence $A$ is SPD. In particular we have computed
$A = LL^âŠ¤$ where
$$
L = \begin{bmatrix}
\sqrt{2} \\
\sqrt{2} & 1 \\
1/\sqrt{2} & 1 & 1/\sqrt{2}
\end{bmatrix}
$$

**END**

----

**Problem 7** Compute the 2-norm condition number of the matrix
$$
\begin{bmatrix} 1 & 1 \\
& 2
\end{bmatrix}
$$

**SOLUTION**

The singular values of $A$ are the square root of the eigenvalues of
$$
A^âŠ¤A = \begin{bmatrix}1 & 1 \\ 1 & 5 \end{bmatrix}
$$
which are the roots of
$$
{\rm det}(A^âŠ¤A - Î»I) = (1-Î»)(5-Î») - 1 = Î»^2 -6Î» + 4
$$
i.e. the square root of
$$
Î» = {6 Â± \sqrt{36 -16} \over 2} = 3 Â±  \sqrt{5}
$$
Thus
$$
Îº(A) = {Ïƒ_1 \over Ïƒ_2} = {\sqrt{3+\sqrt{5}} \over \sqrt{3-\sqrt{5}}}
$$


**END**


-----

**Problem 8** For the function $f(Î¸) = \sin 3 Î¸$, state explicit formulae for its Fourier coefficients
$$
\hat f_k := {1 \over 2Ï€} \int_0^{2Ï€} f(Î¸) {\rm e}^{-{\rm i} k Î¸} {\rm d}Î¸
$$
and  their discrete approximation:  
$$
\hat f_k^n := {1 \over n} \sum_{j=0}^{n-1} f(Î¸_j) {\rm e}^{-{\rm i} k Î¸_j}.
$$
for _all_ integers $k$, $n = 1,2,â€¦$, where $Î¸_j = 2Ï€ j/n$.


-----



**Problem 9** Consider orthogonal polynomials 
$$
H_n(x) = 2^n x^n + O (x^{n-1})
$$ 
as $x â†’ âˆ$ and $n = 0, 1, 2, â€¦$,  orthogonal with respect to the inner product
$$
\langle f, g \rangle = \int_{-âˆ}^âˆ f(x) g(x) w(x) {\rm d}x, \qquad w(x) = \exp(-x^2)
$$
Construct $H_0(x)$, $H_1(x)$, $H_2(x)$ and hence show that $H_3(x) = 8x^3-12x$. You may use without proof the formulae
$$
\int_{-âˆ}^âˆ w(x) {\rm d}x = \sqrt{Ï€}, \int_{-âˆ}^âˆ x^2 w(x) {\rm d}x = \sqrt{Ï€}/2, 
\int_{-âˆ}^âˆ x^4 w(x) {\rm d}x = 3\sqrt{Ï€}/4.
$$

----

**Problem 10** Derive the 3-point Gauss quadrature formula 
$$
\int_{-âˆ}^âˆ f(x) \exp(-x^2) {\rm d}x â‰ˆ w_1 f(x_1) + w_2 f(x_2) + w_3 f(x_3)
$$
with analytic expressions for $x_j$ and $w_j$.