# MATH50003 Numerical Analysis (2022‚Äì23)
# Problem Sheet 3

This problem sheet explores the error in using divided differences and using dual numbers.

Please complete the problems using pen-and-paper, though some can be verified using Julia.

-----
**Problem 1** Suppose our floating point approximation $f^{\rm FP} : F ‚Üí F$  has _relative accuracy_:
$$
f^{\rm FP}(x) = f(x) (1 + Œ¥_x^{\rm r})
$$
where
$$
|Œ¥_x^{\rm r}| ‚â§ c œµ_{\rm m}.
$$
Suppose further that $f(0) = f^{\rm FP}(0) = 0$ and assume that
$f'(0) ‚â†¬†0$. Show that divided differences achieves relative accuracy:
$$
{f^{\rm FP}(h) \over h} = f'(0) (1 + Œµ_h)
$$
where
$$
|Œµ_h| ‚â§ {M \over 2 f'(0)} h (1 + c œµ_{\rm m} )  + c œµ_{\rm m} 
$$
for $M = \sup_{0 ‚â§¬†t ‚â§¬†h} |f''(t)|$.



-------


**Problem 2.1** Use Taylor's theorem to derive an (absolute) error bound for central differences
$$
\left|f'(x) - {f(x + h) - f(x - h) \over 2h}\right|
$$
in terms of 
$$
M = \max_{y ‚àà [x-h,x+h]}\left| f'''(y)\right|.
$$



**Problem 2.2**
Assume that
$$f^{\rm FP}(x) = f(x) + Œ¥_x^f$$
where $|Œ¥_x^f| \leq c œµ_{\rm m}$. For the _absolute error_ $Œ¥_{x,h}^{\rm CD}$ satisfying
$$
{f^{\rm FP}(x+h) ‚äñ f^{\rm FP}(x-h) \over  2h} = f'(x) + Œ¥_{x,h}^{\rm CD}
$$
find a bound on $|Œ¥_{x,h}^{\rm CD}|$ in terms of $M$.
 You may assume all operations result in numbers
in the normalised range and $h = 2^{-n}$.



-----

**Problem 3.1** Use Taylor's theorem to derive an (absolute) error bound on the second-order derivative approximation
$$
\left|f''(x) - {f(x+h) - 2f(x) + f(x-h) \over h^2} \right|
$$
in terms of 
$$
M = \max_{y‚àà[x-h,x+h]}\left|f'''(y)\right|.
$$



**Problem 3.2** Assume that
$$f^{\rm FP}(x) = f(x) + Œ¥_x^f$$
where $|Œ¥_x^f| \leq c œµ_{\rm m}$. For the _absolute error_ $Œ¥_{x,h}^{\rm 2D}$ satisfying
$$
(f^{\rm FP}(x+h) ‚äñ 2f^{\rm FP}(x) ‚äï f^{\rm FP}(x-h)) / h = f''(x) + Œ¥_{x,h}^{\rm 2D}
$$
find a bound on $|Œ¥_{x,h}^{\rm 2D}|$ in terms of $M$ and $F = \sup_{x-h ‚â§ t ‚â§¬†x+h} |f(t)|$.
 You may assume all operations result in numbers
in the normalised range and $h = 2^{-n}$.



------

**Problem 4.1** 
Show that dual numbers $ùîª$ are a _commutative ring_, that is, for all $a,b,c ‚àà ùîª$ the following are satisfied:
1. _additive associativity_: $(a + b) + c = a + (b + c)$
2. _additive commutativity_: $a + b = b + a$
3. _additive identity_: There exists $0 ‚àà ùîª$ such that $a + 0 = a$.
4. _additive inverse_: There exists $-a$ such that $(-a) + a = 0$.
5. _multiplicative associativity_: $(ab)c = a(bc)$
6. _multiplictive commutativity_: $ab = ba$
7. _multiplictive identity_: There exists $1 ‚àà ùîª$ such that $1a= a$.
8. _distributive_: $a(b+c) = ab + ac$



**Problem 4.2** A _field_ is a commutative ring such that $0 ‚â† 1$ and all nonzero elements have a multiplicative inverse, i.e.,
there exists $a^{-1}$ such that $a a^{-1} = 1$. Why isn't $ùîª$ a field?


 
-------

**Problem 5** What is the correct definition of division on dual numbers, i.e.,
$$
(a + b œµ )/(c + d œµ ) = s + t œµ
$$
for what choice of $s$ and $t$? 



------
**Problem 6** Use dual numbers to compute the derivative of the following functions at $x = 0.1$:
$$
\exp(\exp x \cos x + \sin x), \prod_{k=1}^3 \left({x \over k}-1\right),\hbox{ and } f^{\rm s}_2(x) = {1 + {x - 1 \over 2 + {x-1 \over 2}}}
$$

